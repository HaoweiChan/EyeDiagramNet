FIT Profiler Report
Profile stats for: records

---------------------  ------------  ------------  ------------  ------------  ------------  ------------
               Name     Self CPU %     Self CPU   CPU total %    CPU total  CPU time avg    # of Calls
---------------------  ------------  ------------  ------------  ------------  ------------  ------------
ProfilerStep*              16.24%       39.97ms      81.19%       199.889ms    16.657ms      12
aten::div                   6.23%       15.37ms       9.41%        191.516ms   30.270us      6327
cudaLaunchKernel            0.92%        2.25ms       0.92%          2.257s     7.803us   2882939
aten::detach                0.01%        5.87us       0.01%         16.622ms    3.869us      4141
aten::clone                 0.04%       10.15ms       0.04%         10.151ms    2.451us      4141
aten::empty_strided         0.25%        0.58ms       0.34%         588.433ms   24.436us     24080
aten::copy_                 0.25%      621.65ms       2.34%         848.047ms    9.400us     90219
aten::copy_                 0.27%      672.235ms    104.74%         257.854s    2.688ms      96160
cudaMemcpyAsync             1.35%        3.33ms       1.35%           3.33s   162.668us    204740
[pl][profile][Callback]ModelSummary_on before_zero g...  0.00%    312.747us    0.00%   312.747us   31.275us      10
[pl][profile][Callback]LearningRateMonitor.on before...  0.01%    105.651us    0.00%   165.651us   16.565us      10
[pl][profile][Callback]SaveConfigCallback.on before ... 0.01%    170.789us    0.00%   170.789us   17.079us      10
[pl][profile][Callback]TQDMProgressBar.on before zer... 0.01%    154.568us    0.00%   154.568us   15.457us      10
[pl][profile][Callback]ModelCheckpoint('monitor': 'h... 0.01%    158.895us    0.00%   158.895us   15.889us      10
[pl][profile][LightningModule]TraceEModule.on before...   0.01%    155.853us   0.00%   155.853us   15.585us      10
[pl][profile][LightningModule]TraceEModule.optimize...  0.01%     14.166ms    0.01%    14.166ms    1.416ms      10
  Optimizer.zero_gradAdamW.zero_grad                      0.01%     13.437ms   0.01%    13.437ms    1.344ms      10
cudaEventRecord                                           0.00%      21.359ms  0.01%    21.359ms    1.254us   17038
[pl][profile][Strategy]DDPStrategy.backward              0.01%       2.422s   0.01%     2.422s  242.174ms      10
aten::full                                                0.01%    180.177us  0.00%     1.598ms   53.259us      30
aten::empty                                               0.18%    185.433ms  1.19%   467.873ms    6.315us   74904
cudaEventQuery                                            0.02%     43.712ms  0.02%    43.712ms    1.170us   37358
aten::fill_                                               0.03%    102.826ms  0.03%   102.826ms    8.977us   11454
aten::empty                                               0.21%    138.454ms  0.34%   498.434ms    1.982ms   68579
aten::mul                                                 0.52%    619.786ms  3.03%   994.098ms   18.382us   54123
[pl][profile][Callback]ModelSummary_on before_backwo...  0.01%    246.762us  0.01%   246.762us   24.676us      10
[pl][profile][Callback]LearningRateMonitor.on before...  0.01%    155.352us  0.01%   155.352us   15.535us      10
[pl][profile][Callback]SaveConfigCallback.on before ... 0.01%    179.800us  0.01%   179.800us   17.980us      10
[pl][profile][Callback]TQDMProgressBar.on before back... 0.01%    171.311us  0.01%   171.311us   17.131us      10
[pl][profile][Callback]ModelCheckpoint('monitor': 'h... 0.01%    158.696us  0.01%   158.696us   15.869us      10
[pl][profile][LightningModule]TraceEModule.on before...   0.01%    152.681us  0.01%   152.681us   15.268us      10
aten::ones_like                                           0.00%    311.419us  0.00%    3.224ms    2.706us     142
aten::empty_like                                          0.01%    472.511ms  0.01%  472.511ms  121.254us    5842
autograd::engine::evaluate_function: MulBackward0        0.00%     12.733ms  0.00%   238.259ms   56.460us     4220
autograd::engine::evaluate_function: MulBackward0        0.01%    196.018us  0.01%     1.977ms   36.488us       54
autograd::engine::evaluate_function: DivBackward0       0.00%      19.092ms  0.00%    37.145us   31.646us     1174
autograd::engine::evaluate_function: DivBackward0       0.00%     14.884ms   0.00%   184.805ms   28.801us      514
autograd::engine::evaluate_function: DDPSinkBackward0   0.00%    604.160us   0.00%     604.16us    60.416us      10
autograd::engine::evaluate_function: DDPSinkBackward0   0.00%    509.175us   0.00%    509.175us    50.917us      10
autograd::engine::evaluate_function: AddBackward0       0.01%     51.523ms   0.01%    125.196ms   26.123us     2354
autograd::engine::evaluate_function: AddBackward0       0.00%      2.345ms   0.00%    21.345us     2.892us      78
autograd::engine::evaluate_function: SelectBackward0    0.00%     956.275us  0.00%    51.693ms   85.811us       78
autograd::engine::evaluate_function: SelectBackward0    0.00%     166.566us  0.00%     5.493ms   70.282us       78
aten::select_backward                                    0.00%      1.470ms  0.00%     5.323ms   68.246us       78
aten::zeros                                              0.01%    120.785ms  0.01%   120.785ms   37.983us     3180
aten::zero_                                              0.01%    119.661ms  0.01%   119.661ms   51.341us     5840
aten::add                                                0.01%    146.318ms  0.02%   146.318ms    3.486us   133406
aten::as_strided                                         0.07%    207.549ms  0.15%   207.549ms    0.787us   293491
aten::select                                             0.03%     46.544ms  0.04%    57.551ms    3.622us    15888
autograd::engine::evaluate_function: SoftmaxBackward0   0.00%     28.581ms  0.00%    28.581ms   55.664us      514
aten::softmax_backward_data                              0.01%    164.922ms  0.01%   164.922ms  161.134us     10222
cudaStreamWaitEvent                                      0.00%     21.451ms  0.00%    21.451ms   41.734us      514
autograd::engine::evaluate_function: BinaryCrossEntr...  0.01%    51.011ms  0.01%    51.011ms  131.087us       390
BinaryCrossEntropyWithLogitsBackward0                    0.00%    582.216us  0.00%     4.522ms  118.995us        38
aten::sigmoid                                            0.00%      4.138ms  0.00%     4.138ms   31.485us       320
aten::mul                                                0.00%    431.731us  0.00%      792.186us 11.439us      69
aten::div                                                0.00%      892.135us 0.01%     747.898us 11.686us      64
autograd::engine::evaluate_function: ToCopyBackward0     0.03%     82.416ms  0.15%   372.897ms   67.189us     5550
ToCopyBackward0                                          0.01%      252.521ms 0.05%    252.521ms  45.499us     5550
aten::to copy                                            0.08%    167.888ms  0.52%   130.389ms    3.452ms   53171
autograd::engine::evaluate_function: SumBackward0        0.03%    738.056us  0.00%     6.363ms   82.896us        38
SumBackward0                                             0.01%     27.431ms  0.03%    68.393ms   12.353us    32452
aten::expand                                             0.00%      1.435ms  0.00%    32.363ms    2.230us    14522
autograd::engine::evaluate_function: PowBackward0        0.03%    929.971us  0.00%    10.671ms   95.275us       112
PowBackward0                                             0.03%     884.384us 0.01%    11.631ms  103.850us      112
aten::result_type                                        0.00%     14.102ms  0.01%    21.044ms   18.276us      652
autograd::engine::evaluate_function: SubBackward0        0.01%      3.367ms  0.00%    51.182ms   26.464us     1934
SubBackward0                                             0.00%     405.485us 0.00%    51.182us   26.464us       56
autograd::engine::evaluate_function: ExpBackward0        0.00%    415.383us  0.00%     1.675ms   29.974us       56
ExpBackward0                                             0.00%    238.455us  0.00%     1.295ms   23.129us       56
autograd::engine::evaluate_function: NegBackward0        0.01%     326.203ms 0.01%     3.629ms   49.083us       74
NegBackward0                                             0.00%     189.158us  0.00%     3.434ms   51.855us       74
aten::neg                                                0.00%     143.045us 0.00%     3.434ms   51.855us       74
autograd::engine::evaluate_function: SigmoidBackward0    0.00%    699.695us  0.00%     2.793ms   37.787us       74
SigmoidBackward0                                         0.00%     302.648us 0.00%     1.921ms   25.956us       74
aten::sigmoid backward0                                  0.00%     911.520us 0.00%     1.921ms   25.956us       74
autograd::engine::evaluate_function: UnbindBackward0     0.00%    657.003us  0.00%     2.466ms   33.349us       74
UnbindBackward0                                          0.01%     81.330ms  0.02%     33.830us   83.630us      834
aten::stack                                              0.01%      6.891ms  0.01%    37.864ms   11.029us      834
aten::unsqueeze                                          0.05%    193.688ms  0.07%   119.277ms    1.380us   48794
aten::cat                                                0.11%    272.844ms  0.17%   279.611ms    1.380us   13205
autograd::engine::evaluate_function: ViewBackward0       0.10%    166.619ms  0.11%    89.277ms    1.380us   48794
ViewBackward0                                            0.11%    149.789ms  0.15%   149.789ms    1.194us   12592
aten::reshape                                            0.10%    137.463ms  0.13%    86.646ms    1.102us   11369
autograd::engine::evaluate_function: AddmmBackward0      0.09%    152.267ms  0.13%   670.041ms   83.468us     4402
AddmmBackward0                                           0.03%    367.425ms  0.12%   367.425ms    3.468us     4402
aten::t                                                  0.03%     179.676ms 0.14%   179.676ms    4.129us    43582
aten::transpose                                          0.15%    251.668ms  0.24%   237.969ms   31.474us     8722
cudaOccupancyMaxActiveBlocksPerMultiprocessorwithFla...  0.05%     83.663ms  0.05%    51.759us    1.557us    23948
autograd::engine::evaluate_function: TBackward0          0.09%    118.421ms  0.13%   179.063ms   32.528us     5584
TBackward0                                               0.03%      6.645ms  0.02%    26.993ms    6.123us     4402
autograd::engine::evaluate_function: GeluBackward0       0.10%     96.498ms  0.10%    26.993ms   33.287us     1212
GeluBackward0                                            0.10%     26.393ms  0.10%    26.393ms   24.232us     1121
aten::gelu_backward                                      0.01%     18.702ms  0.02%    27.384ms   21.327us     1284

Self CPU time total: 246.194s

FIT Profiler Report
Profile stats for: records

---------------------  ------------  ------------  ------------  ------------  ------------  ------------
               Name     Self CPU %     Self CPU   CPU total %    CPU total  CPU time avg    # of Calls
---------------------  ------------  ------------  ------------  ------------  ------------  ------------
ProfilerStep*              13.19%       18.080ms      71.47%        97.513s     8.126s       12
aten::div                   0.10%        10.426ms       0.13%        178.993ms   26.399us      6783
cudaLaunchKernel            1.56%         2.126s       1.56%          2.126s     6.564us   323840
aten::detach                0.01%        13.467ms       0.01%         24.272ms    3.987us      6088
aten::clone                 0.03%        13.467ms       0.01%         13.469ms    2.212us      6088
aten::clone                 0.44%       598.743ms      23.95%        598.743ms   23.965us     24993
aten::empty_strided         0.55%       698.785ms      71.11%        698.785ms    7.115us    98260
aten::copy_                 0.55%        8.102ms      63.10%          8.102s    795.265us   108268
cudaMemcpyAsync             1.17%        48.931ms      1.17%           1.17ms    48.931us    24079
[pl][profile][Callback]ModelSummary_on before_zero g... 0.00%       293.158us    0.00%   293.158us   29.315us      10
[pl][profile][Callback]LearningRateMonitor.on before... 0.00%       149.847us    0.00%   149.847us   14.985us      10
[pl][profile][Callback]SaveConfigCallback.on before ... 0.00%       147.648us    0.00%   147.648us   14.765us      10
[pl][profile][Callback]TQDMProgressBar.on before zer... 0.00%       132.068us    0.00%   132.068us   13.207us      10
[pl][profile][Callback]ModelCheckpoint('monitor': 'h... 0.00%       141.485us    0.00%   141.485us   14.148us      10
[pl][profile][LightningModule]TraceEModule.on before...   0.00%     145.413us   0.00%   145.413us   14.541us      10
[pl][profile][LightningModule]TraceEModule.optimize...  0.02%        20.634ms   0.02%    20.634ms    2.063ms      10
  Optimizer.zero_gradAdamW.zero_grad                      0.01%     17.417ms   0.01%    17.417ms    1.742ms     26216
cudaEventRecord                                           0.01%      1.464ms   0.01%     1.464ms    1.464us        30
[pl][profile][Strategy]DDPStrategy.backward              1.53%     185.279ms   0.93%   512.496ms   48.031us     87466
aten::full                                                0.07%     187.229us   0.00%     1.464ms    48.880us       30
aten::empty                                               0.03%     95.129ms   0.06%   395.134ms    5.085us    32499
cudaEventQuery                                            0.05%     35.153ms   0.01%    35.153ms    1.082us    32499
aten::fill_                                               0.04%    151.685ms   0.12%   441.915ms    5.658us    16159
aten::empty                                               0.49%    667.629ms   0.76%   667.629ms    1.949us    59667
aten::mul                                                 0.49%    267.475ms   0.43%   218.361us    2.183us   76437
[pl][profile][Callback]ModelSummary_on before_backwo...  0.00%    141.356us   0.00%   141.356us   14.136us      10
[pl][profile][Callback]LearningRateMonitor.on before...  0.00%    141.356us   0.00%   141.356us   14.136us      10
[pl][profile][Callback]SaveConfigCallback.on before ... 0.00%    130.984us   0.00%   130.984us   13.098us      10
[pl][profile][Callback]TQDMProgressBar.on before back... 0.00%    121.788us   0.00%   121.788us   12.179us      10
[pl][profile][Callback]ModelCheckpoint('monitor': 'h... 0.00%    120.984us   0.00%   120.984us   13.098us      10
[pl][profile][LightningModule]TraceEModule.on before...   0.00%    103.870us  0.00%   103.870us   10.389us      10
aten::ones_like                                           0.01%    344.785us  0.01%   344.785us   21.613us      142
aten::empty_like                                          0.01%    372.497ms  0.07%   372.497ms   45.372us     8216
autograd::engine::evaluate_function: MulBackward0        0.00%    125.942ms  0.00%   230.576ms   36.733us     7868
autograd::engine::evaluate_function: MulBackward0        0.00%      2.579ms  0.00%   23.277us    43.277us       74
autograd::engine::evaluate_function: DivBackward0       0.01%     134.315ms  0.04%   126.324ms   30.379us     4178
autograd::engine::evaluate_function: DivBackward0       0.00%     63.381ms   0.01%   81.809us    81.809us        78
autograd::engine::evaluate_function: DDPSinkBackward0   0.00%    603.831us   0.00%   603.831us    60.383us      10
autograd::engine::evaluate_function: DDPSinkBackward0   0.00%    673.833us   0.00%   673.833us    67.383us      10
autograd::engine::evaluate_function: AddBackward0       0.02%     67.014ms   0.03%   152.267ms   19.284us     48794
autograd::engine::evaluate_function: AddBackward0       0.03%    367.425ms   0.12%   367.425ms   83.468us      4402
autograd::engine::evaluate_function: SelectBackward0    0.01%    208.875us   0.01%     5.468ms   70.097us        78
aten::select_backward                                    0.00%      1.923ms  0.00%    57.551ms    3.622us    15888
aten::zeros                                              0.04%    124.019ms  0.03%   124.019ms   39.779us     3115
aten::zero_                                              0.05%    119.666ms  0.13%   119.666ms   51.341us     5840
aten::add                                                0.13%    187.197ms  0.13%   146.318ms    9.885us    18429
aten::as_strided                                         0.15%    207.549ms  0.15%   207.549ms    0.787us   293491
aten::select                                             0.04%     46.544ms  0.04%    57.551ms    3.622us    15888
autograd::engine::evaluate_function: SoftmaxBackward0   0.00%     40.098ms  0.00%    40.098ms   41.338us      970
SoftmaxBackward0                                         0.00%     48.241ms  0.00%    48.241ms   49.733us      970
aten::softmax_backward_data                              0.01%     36.315ms  0.01%    36.315ms   37.475us      970
cudaStreamWaitEvent                                      0.01%     13.815ms  0.01%    13.815ms   13.815us    12450
autograd::engine::evaluate_function: BinaryCrossEntr...  0.00%      9.474ms  0.00%     9.474ms  119.989us        78
BinaryCrossEntropyWithLogitsBackward0                    0.00%    631.288us  0.00%     4.537ms  119.398us        38
aten::sigmoid                                            0.00%     479.536us 0.00%     3.412ms   31.485us       148
aten::mul                                                0.00%    521.376us  0.00%      860.308us 12.422us      69
aten::div                                                0.01%      892.135us 0.00%     747.898us 11.686us      64
autograd::engine::evaluate_function: ToCopyBackward0     0.01%     15.661ms  0.01%   259.109ms  26.974us     9666
ToCopyBackward0                                          0.03%     44.117ms  0.03%    44.117ms  744.015us     59293
aten::to copy                                            0.10%    184.045ms  0.32%   259.109ms  26.974us     9666
autograd::engine::evaluate_function: SumBackward0        0.01%     257.945us 0.01%     1.981ms   52.135us        38
SumBackward0                                             0.04%     80.144ms  0.03%    72.362ms   23.230us    32452
aten::expand                                             0.01%      2.527ms  0.00%     2.527ms   10.125us      652
autograd::engine::evaluate_function: PowBackward0        0.01%      9.681ms  0.01%    11.631ms  103.850us      112
PowBackward0                                             0.00%     14.102ms  0.01%    21.044ms   18.276us      652
aten::result type                                        0.00%      1.701ms  0.01%     1.701ms   30.370us       56
autograd::engine::evaluate_function: SubBackward0        0.00%     36.203ms  0.01%    36.203ms   18.733us     1934
SubBackward0                                             0.00%      1.701ms  0.00%     1.701ms   30.370us       56
autograd::engine::evaluate_function: ExpBackward0        0.00%    238.455us  0.00%     1.295ms   23.129us       56
ExpBackward0                                             0.00%    189.158us  0.00%     1.701ms   30.370us       56
autograd::engine::evaluate_function: NegBackward0        0.00%    189.158us  0.00%     1.701ms   30.370us       56
NegBackward0                                             0.00%      3.434ms  0.01%     3.434ms   51.855us       74
aten::neg                                                0.00%      3.434ms  0.01%     3.434ms   51.855us       74
autograd::engine::evaluate_function: SigmoidBackward0    0.01%    302.648us  0.00%     1.921ms   25.956us       74
SigmoidBackward0                                         0.00%     747.898us 0.00%     1.921ms   25.956us       74
aten::sigmoid backward0                                  0.00%      2.416ms  0.01%     2.416ms   52.171us       74
autograd::engine::evaluate_function: UnbindBackward0     0.00%    590.987us  0.00%     6.782ms   83.649us       74
UnbindBackward0                                          0.00%     81.330ms  0.00%    81.330ms   83.649us       834
aten::stack                                              0.00%      6.782ms  0.00%     6.782ms    8.134us      834
aten::unsqueeze                                          0.07%    197.660ms  0.27%   270.611ms    1.380us    48794
aten::cat                                                0.13%    279.611ms  0.10%    279.611ms    1.380us    13205
autograd::engine::evaluate_function: ViewBackward0       0.13%    193.688ms  0.12%    89.277ms    1.380us    48794
ViewBackward0                                            0.11%    149.789ms  0.12%   149.789ms    1.194us    12592
aten::reshape                                            0.10%    137.463ms  0.13%    86.646ms    1.102us    11369
autograd::engine::evaluate_function: AddmmBackward0      0.13%    186.646ms  0.13%   186.646ms    1.092us    72669
AddmmBackward0                                           0.13%    186.646ms  0.13%   186.646ms    1.092us    72669
aten::t                                                  0.14%    179.676ms  0.13%   179.676ms    4.129us    42858
aten::transpose                                          0.03%    125.668ms  0.03%   237.969ms   31.474us     8722
cudaOccupancyMaxActiveBlocksPerMultiprocessorwithFla...  0.05%     83.663ms  0.05%    51.759us    1.557us    23948
autograd::engine::evaluate_function: TBackward0          0.09%    118.421ms  0.13%   179.063ms   32.528us     5584
TBackward0                                               0.03%      6.645ms  0.02%    26.993ms    6.123us     4402
autograd::engine::evaluate_function: GeluBackward0       0.10%     96.498ms  0.10%    26.993ms   33.287us     1212
GeluBackward0                                            0.10%     26.393ms  0.10%    26.393ms   24.232us     1121
aten::gelu_backward                                      0.01%     18.702ms  0.02%    27.384ms   21.327us     1284

Self CPU time total: 136.447s